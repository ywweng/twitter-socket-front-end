(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-446c8a81"],{"3d4f":function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal fade",attrs:{id:"new-reply-modal",tabindex:"-1","aria-labelledby":"newReplyModalLabel","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog"},[a("div",{staticClass:"modal-content"},[t._m(0),a("div",{staticClass:"modal-body d-flex flex-column"},[a("div",{staticClass:"tweet-card d-flex"},[a("div",{staticClass:"h-100 d-flex flex-column"},[a("img",{staticClass:"avatar",attrs:{src:t.tweet.User.avatar,alt:"",width:"50px",height:"50px"}}),a("div",{staticClass:"border ms-4"})]),a("div",{staticClass:"tweet-info d-flex flex-column"},[a("div",{staticClass:"h-100"},[a("span",{staticClass:"text-name me-2"},[t._v(t._s(t.tweet.User.name))]),a("span",{staticClass:"text-account"},[t._v("@"+t._s(t.tweet.User.account)+"．"+t._s(t._f("fromNow")(t.tweet.createdAt)))])]),a("div",{staticClass:"tweet-content"},[t._v(" "+t._s(t.tweet.description)+" ")]),a("div",[a("span",{staticClass:"text-account"},[t._v("回覆給")]),a("span",{staticClass:"text-tag ms-2"},[t._v("@"+t._s(t.tweet.User.name))])])])]),a("div",{staticClass:"reply-content d-flex"},[a("div",[a("img",{staticClass:"avatar",attrs:{width:"50px",src:t.currentUser.avatar,alt:""}})]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"comment"}],staticClass:"input-new-tweet mt-2",attrs:{rows:"5",cols:"50",placeholder:"推你的回覆"},domProps:{value:t.comment},on:{input:function(e){e.target.composing||(t.comment=e.target.value)}}})])]),a("div",{staticClass:"modal-footer"},[t.isError?a("span",{staticClass:"text-danger"},[t._v(t._s(t.errorMsg))]):t._e(),a("button",{staticClass:"btn-active",attrs:{type:"submit"},on:{click:t.handleSubmit}},[t._v(" 回覆 ")])])])]),!1!==t.alertStatus?a("div",{staticClass:"alert d-flex fixed-top",attrs:{id:"alert",role:"alert"}},[a("div",{staticClass:"ms-2 mx-auto my-auto text-alert"},[t._v(t._s(t.alertMsg))]),a("div",{staticClass:"ms-auto"},["error"===t.alertStatus?a("img",{attrs:{src:r("ba0e")}}):"success"===t.alertStatus?a("img",{attrs:{src:r("08f6")}}):t._e()])]):t._e()])},s=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"modal-header"},[r("button",{staticClass:"btn-close",attrs:{type:"button","data-bs-dismiss":"modal","aria-label":"Close"}})])}],n=r("1da1"),i=r("5530"),c=(r("96cf"),r("d9e2"),r("c1df")),o=r.n(c),u=r("2f62"),l=r("6783"),d={name:"NewReplyModal",props:{tweet:{type:[Array,Object]}},data:function(){return{comment:"",alertMsg:"",alertStatus:!1,isError:!1,errorMsg:""}},computed:Object(i["a"])({},Object(u["b"])(["currentUser"])),filters:{fromNow:function(t){return t?o()(t).fromNow():"-"}},methods:{alertShow:function(){var t=this,e=r("7b17"),a=document.querySelector("#alert");e.Alert.getInstance(a),setTimeout((function(){t.alertStatus=!1}),2e3)},hideModal:function(){var t=r("7b17"),e=document.querySelector("#new-reply-modal"),a=t.Modal.getInstance(e);setTimeout((function(){a.hide()}),1e3)},handleSubmit:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t.comment){e.next=5;break}return t.isError=!0,t.errorMsg="內容不可空白",e.abrupt("return");case 5:return e.next=7,l["a"].postTweetReply({id:t.tweet.id,comment:t.comment});case 7:if(r=e.sent,a=r.data,"error"!==a.status){e.next=11;break}throw new Error(a.message);case 11:t.$emit("after-reply-submit",{tweetId:t.tweet.id,replyCount:t.tweet.replyCount+1}),t.$emit("after-single-reply",{User:t.currentUser,comment:t.comment,created_at:(new Date).toISOString()}),t.alertMsg="留言成功",t.alertStatus="success",t.alertShow(),t.comment="",t.hideModal(),e.next=26;break;case 20:e.prev=20,e.t0=e["catch"](0),t.comment="",t.alertMsg=e.t0.response.data.message,t.alertStatus="error",t.alertShow();case 26:case"end":return e.stop()}}),e,null,[[0,20]])})))()}}},f=d,p=(r("78c9"),r("2877")),m=Object(p["a"])(f,a,s,!1,null,"424fbc06",null);e["a"]=m.exports},6211:function(t,e,r){t.exports=r.p+"img/Reply.c76ba41a.svg"},6783:function(t,e,r){"use strict";r("a4d3"),r("e01a");var a=r("2fa3");e["a"]={getTweets:function(){return a["b"].get("/tweets")},getOneTweet:function(t){var e=t.id;return a["b"].get("/tweets/".concat(e))},postTweet:function(t){var e=t.description;return a["b"].post("/tweets",{description:e})},getTweetReplies:function(t){var e=t.id;return a["b"].get("/tweets/".concat(e,"/replies"))},postTweetReply:function(t){var e=t.id,r=t.comment;return a["b"].post("/tweets/".concat(e,"/replies"),{comment:r})},addLike:function(t){var e=t.id;return a["b"].post("/tweets/".concat(e,"/like"))},deleteLike:function(t){var e=t.id;return a["b"].post("/tweets/".concat(e,"/unlike"))}}},7082:function(t,e,r){"use strict";r("b191")},7156:function(t,e,r){var a=r("1626"),s=r("861d"),n=r("d2bb");t.exports=function(t,e,r){var i,c;return n&&a(i=e.constructor)&&i!==r&&s(c=i.prototype)&&c!==r.prototype&&n(t,c),t}},"78c9":function(t,e,r){"use strict";r("bedf")},9267:function(t,e,r){t.exports=r.p+"img/LikeActive.b9abe96b.svg"},"9bf3":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"w-100",attrs:{id:"single-tweet"}},[t.isLoading?a("Spinner"):t._e(),a("div",{staticClass:"title menu-text"},[a("button",{staticClass:"d-flex",attrs:{type:"button"},on:{click:function(e){return t.$router.go(-1)}}},[a("img",{staticClass:"my-auto",attrs:{src:r("ccfe"),width:"17px",height:"14px"}}),a("span",{staticClass:"ms-4 my-auto menu-text"},[t._v("推文")])])]),a("div",{staticClass:"tweet-section d-flex flex-column"},[a("div",{staticClass:"user-info d-flex"},[a("div",[a("img",{staticClass:"avatar",attrs:{src:t.tweet.User.avatar,alt:""}})]),a("div",{staticClass:"d-flex flex-column"},[a("span",{staticClass:"text-name"},[t._v(t._s(t.tweet.User.name))]),a("span",{staticClass:"text-account"},[t._v("@"+t._s(t.tweet.User.account))])])]),a("div",{staticClass:"tweet d-flex flex-column w-100"},[a("div",{staticClass:"tweet-content"},[t._v(" "+t._s(t.tweet.description)+" ")]),a("div",{staticClass:"tweet-time w-100"},[t._v(t._s(t._f("format")(t.tweet.createdAt)))]),a("div",{staticClass:"like-reply"},[a("span",{staticClass:"text-reply"},[a("strong",[t._v(t._s(t.tweet.replyCount))]),t._v(" 回覆")]),a("span",{staticClass:"text-like"},[a("strong",[t._v(t._s(t.tweet.likeCount))]),t._v(" 喜歡次數")])]),a("div",{staticClass:"action"},[a("button",{staticClass:"btn-reply",attrs:{"data-bs-toggle":"modal","data-bs-target":"#new-reply-modal"}},[a("img",{attrs:{src:r("6211")}})]),t.tweet.isLiked?a("button",{staticClass:"btn-like",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.deleteLike(t.tweet.id)}}},[a("img",{attrs:{src:r("9267"),width:"24px"}})]):a("button",{staticClass:"btn-like",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.addLike(t.tweet.id)}}},[a("img",{attrs:{src:r("cb58")}})])])])]),a("div",{staticClass:"replies",attrs:{id:"reply-list"}},t._l(t.replies,(function(e){return a("div",{key:e.id,staticClass:"reply-card d-flex"},[a("div",[a("img",{staticClass:"avatar",attrs:{src:e.User.avatar,alt:""}})]),a("div",{staticClass:"tweet-info d-flex flex-column justify-content-evenly w-100 h-100"},[a("div",{},[a("span",{staticClass:"text-name me-2"},[t._v(t._s(e.User.name))]),a("span",{staticClass:"text-account"},[t._v("@"+t._s(e.User.account)+"．"+t._s(t._f("fromNow")(e.createdAt)))])]),a("div",[a("span",{staticClass:"text-account"},[t._v("回覆")]),a("span",{staticClass:"text-tag ms-2"},[t._v("@"+t._s(t.tweet.User.account))])]),a("div",[t._v(t._s(e.comment))])])])})),0),a("NewReplyModal",{attrs:{tweet:t.tweet},on:{"after-single-reply":t.afterSingleReply}})],1)},s=[],n=r("1da1"),i=r("5530"),c=(r("d9e2"),r("96cf"),r("6783")),o=r("3d4f"),u=r("2375"),l=r("2f62"),d=r("c1df"),f=r.n(d),p={name:"SingleTweet",components:{NewReplyModal:o["a"],Spinner:u["a"]},data:function(){return{tweet:[],replies:[],alertMsg:"",alertStatus:!1,isProcessing:!1,isLoading:!0}},computed:Object(i["a"])({},Object(l["b"])(["currentUser"])),filters:{format:function(t){return t?(f.a.locale("zh-tw"),f()(t).format("A hh:mm．LL")):"-"},fromNow:function(t){return t?f()(t).fromNow():"-"}},created:function(){this.fetchTweet(),this.fetchReplies()},methods:{alertShow:function(){var t=this,e=r("7b17"),a=document.querySelector("#alert");e.Alert.getInstance(a),setTimeout((function(){t.alertStatus=!1}),2e3)},fetchTweet:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c["a"].getOneTweet({id:t.$route.params.tweetId});case 3:r=e.sent,a=r.data,t.tweet=a,t.isLoading=!1,e.next=14;break;case 9:e.prev=9,e.t0=e["catch"](0),t.alertMsg="載入推文失敗，請稍後再試",t.alertStatus="error",t.alertShow();case 14:case"end":return e.stop()}}),e,null,[[0,9]])})))()},fetchReplies:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c["a"].getTweetReplies({id:t.tweet.id||t.$route.params.tweetId});case 3:if(r=e.sent,a=r.data,"error"!==a.status){e.next=7;break}throw new Error(a.message);case 7:t.replies=a,e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](0),t.alertMsg="載入留言失敗，請稍後再試",t.alertStatus="error",t.alertShow();case 15:case"end":return e.stop()}}),e,null,[[0,10]])})))()},addLike:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var a,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,c["a"].addLike({id:t});case 3:if(a=r.sent,s=a.data,e.isProcessing=!0,"error"!==s.status){r.next=8;break}throw new Error(s.message);case 8:e.tweet.likeCount=e.tweet.likeCount+1,e.tweet.isLiked=!0,e.isProcessing=!1,r.next=18;break;case 13:r.prev=13,r.t0=r["catch"](0),e.alertMsg="按讚失敗，請稍後再試",e.alertStatus="error",e.alertShow();case 18:case"end":return r.stop()}}),r,null,[[0,13]])})))()},deleteLike:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var a,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,c["a"].deleteLike({id:t});case 3:if(a=r.sent,s=a.data,e.isProcessing=!0,"error"!==s.status){r.next=8;break}throw new Error(s.message);case 8:e.tweet.likeCount=e.tweet.likeCount-1,e.tweet.isLiked=!1,e.isProcessing=!1,r.next=18;break;case 13:r.prev=13,r.t0=r["catch"](0),e.alertMsg="按讚失敗，請稍後再試",e.alertStatus="error",e.alertShow();case 18:case"end":return r.stop()}}),r,null,[[0,13]])})))()},afterSingleReply:function(t){this.replies.unshift(Object(i["a"])({},t)),this.tweet.replyCount=this.tweet.replyCount+1}}},m=p,v=(r("7082"),r("2877")),w=Object(v["a"])(m,a,s,!1,null,"3d6983e5",null);e["default"]=w.exports},ab36:function(t,e,r){var a=r("861d"),s=r("9112");t.exports=function(t,e){a(e)&&"cause"in e&&s(t,"cause",e.cause)}},b191:function(t,e,r){},b980:function(t,e,r){var a=r("d039"),s=r("5c6c");t.exports=!a((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",s(1,7)),7!==t.stack)}))},bedf:function(t,e,r){},c770:function(t,e,r){var a=r("e330"),s=a("".replace),n=function(t){return String(Error(t).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,c=i.test(n);t.exports=function(t,e){if(c&&"string"==typeof t)while(e--)t=s(t,i,"");return t}},cb58:function(t,e,r){t.exports=r.p+"img/Like.236f4f7d.svg"},ccfe:function(t,e,r){t.exports=r.p+"img/back.f3e5a7a2.svg"},d9e2:function(t,e,r){var a=r("23e7"),s=r("da84"),n=r("2ba4"),i=r("e5cb"),c="WebAssembly",o=s[c],u=7!==Error("e",{cause:7}).cause,l=function(t,e){var r={};r[t]=i(t,e,u),a({global:!0,forced:u},r)},d=function(t,e){if(o&&o[t]){var r={};r[t]=i(c+"."+t,e,u),a({target:c,stat:!0,forced:u},r)}};l("Error",(function(t){return function(e){return n(t,this,arguments)}})),l("EvalError",(function(t){return function(e){return n(t,this,arguments)}})),l("RangeError",(function(t){return function(e){return n(t,this,arguments)}})),l("ReferenceError",(function(t){return function(e){return n(t,this,arguments)}})),l("SyntaxError",(function(t){return function(e){return n(t,this,arguments)}})),l("TypeError",(function(t){return function(e){return n(t,this,arguments)}})),l("URIError",(function(t){return function(e){return n(t,this,arguments)}})),d("CompileError",(function(t){return function(e){return n(t,this,arguments)}})),d("LinkError",(function(t){return function(e){return n(t,this,arguments)}})),d("RuntimeError",(function(t){return function(e){return n(t,this,arguments)}}))},e01a:function(t,e,r){"use strict";var a=r("23e7"),s=r("83ab"),n=r("da84"),i=r("e330"),c=r("1a2d"),o=r("1626"),u=r("3a9b"),l=r("577e"),d=r("9bf2").f,f=r("e893"),p=n.Symbol,m=p&&p.prototype;if(s&&o(p)&&(!("description"in m)||void 0!==p().description)){var v={},w=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:l(arguments[0]),e=u(m,this)?new p(t):void 0===t?p():p(t);return""===t&&(v[e]=!0),e};f(w,p),w.prototype=m,m.constructor=w;var b="Symbol(test)"==String(p("test")),g=i(m.toString),h=i(m.valueOf),x=/^Symbol\((.*)\)[^)]+$/,C=i("".replace),y=i("".slice);d(m,"description",{configurable:!0,get:function(){var t=h(this),e=g(t);if(c(v,t))return"";var r=b?y(e,7,-1):C(e,x,"$1");return""===r?void 0:r}}),a({global:!0,forced:!0},{Symbol:w})}},e391:function(t,e,r){var a=r("577e");t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:a(t)}},e5cb:function(t,e,r){"use strict";var a=r("d066"),s=r("1a2d"),n=r("9112"),i=r("3a9b"),c=r("d2bb"),o=r("e893"),u=r("7156"),l=r("e391"),d=r("ab36"),f=r("c770"),p=r("b980"),m=r("c430");t.exports=function(t,e,r,v){var w=v?2:1,b=t.split("."),g=b[b.length-1],h=a.apply(null,b);if(h){var x=h.prototype;if(!m&&s(x,"cause")&&delete x.cause,!r)return h;var C=a("Error"),y=e((function(t,e){var r=l(v?e:t,void 0),a=v?new h(t):new h;return void 0!==r&&n(a,"message",r),p&&n(a,"stack",f(a.stack,2)),this&&i(x,this)&&u(a,this,y),arguments.length>w&&d(a,arguments[w]),a}));if(y.prototype=x,"Error"!==g&&(c?c(y,C):o(y,C,{name:!0})),o(y,h),!m)try{x.name!==g&&n(x,"name",g),x.constructor=y}catch(_){}return y}}}}]);
//# sourceMappingURL=chunk-446c8a81.f349f6e0.js.map